## <center>GPU 版 YOLO v8 环境配置

### 第一步：安装 PyTorch GPU 版 (核心步骤)

在 Windows 上直接运行 `pip install ultralytics` 往往会默认安装 CPU 版。我们需要通过指定的命令来安装针对显卡的 GPU 支持库。
- **步骤：**
1. **查看你的显卡支持的 CUDA 版本：**
在 `cmd` 中输入：
```bash
nvidia-smi
```
- 看右上角的 **CUDA Version**（例如 12.2 或 11.8）。你的 PyTorch 版本不能高于这个数。

确保你还在 `(yolo)` 环境下，运行这行命令：

```bash
# 安装支持 CUDA 12.4 的 PyTorch (笔者使用RTX4060，CUDA驱动支持到 12.7，故安装 12.4)
pip install torch torchvision torchaudio --index-url https://download.pytorch.org/whl/cu124
# 修改链接最后的 cuxxx 即可
```

---

### 第二步：安装 YOLO v8 (Ultralytics 库)

这一步与 CPU 版相同，但因为它会检测到你已经装好了 GPU 版的 PyTorch，所以它不会再乱装 CPU 版。

```bash
pip install ultralytics -i https://pypi.tuna.tsinghua.edu.cn/simple
```

---

### 第三步：编写程序进行验证

1. 新建一个文件夹，命名为 `yolo_study`
2. 在这个文件夹里新建`hello_yolo.py`
3. 复制下面的代码：

```python
from ultralytics import YOLO
import torch

print("--------------------------------")
print(f"PyTorch 版本: {torch.__version__}")

# 这里必须显示 True，否则说明有问题！
is_cuda = torch.cuda.is_available()
print(f"CUDA (显卡加速) 可用: {is_cuda}") 

if is_cuda:
    # 应该显示你的显卡型号，例如 NVIDIA GeForce RTX 4060
    print(f"检测到显卡设备: {torch.cuda.get_device_name(0)}")
print("--------------------------------")

print("正在下载并加载 YOLOv8n 模型...")
model = YOLO('yolov8n.pt')

print("正在检测测试图片 (强制使用 GPU)...")
# device=0 代表强制使用显卡运行
results = model('https://ultralytics.com/images/bus.jpg', device=0)

print("\n✅ 恭喜！你的 GPU 加速环境配置完美！")
print("--------------------------------")
```

4. 直接在 VS Code 的终端里运行
- 注意：在 VS code中，需要先调整为`(yolo)`环境
- 步骤如下
  1.看 **VS Code 的右下角**
  2.找到 Python 版本号（比如 `3.x.x`）
  3.**点击它**，屏幕正上方会弹出一个列表
  4.在列表里找到 **`('yolo': conda)`**并选中它。
  5.等待右下角的版本号已经带有`(yolo)`字样后，运行即可。

**若看到 `✅ 恭喜！` 的字样，和 `image 1/1 ... 4 persons, 1 bus` 的检测结果，那就说明配置成功**